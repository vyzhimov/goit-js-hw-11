{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,0BAKMC,EAAQC,SAASC,eAAe,eAChCC,EAAeF,SAASG,cAAc,YACtCC,EAAaJ,SAASG,cAAc,oBACpCE,EAAoB,IAAI,EAAAC,EAAAC,SAC1BC,GAAa,EA0BjB,SAASC,IACP,OAAOJ,EACJK,aACAC,MAAK,SAAAC,GACwB,IAAxBA,EAAQC,KAAKC,SAA+B,IAAfN,IAC/BO,EAAAlB,GAASmB,OAAOC,QACd,4EAEFb,EAAWc,UAAUC,IAAI,WAG3B,IAAMC,EAAQR,EAAQS,UAEtB,OADAhB,EAAkBiB,aAAaF,GACxBR,EAAQC,KAAKU,QAClB,SAACC,EAAQC,G,OA2BfC,GADoBC,EA1BkBF,GA2BtCC,aACAE,EAFoBD,EAEpBC,cACAC,EAHoBF,EAGpBE,KACAC,EAJoBH,EAIpBG,MACAC,EALoBJ,EAKpBI,MACAC,EANoBL,EAMpBK,SACAC,EAPoBN,EAOpBM,UAEO,qDAEsCC,OAA5BN,EAAc,gBAAoCM,OAAtBR,EAAa,WAGvBQ,OAHgCL,EAAK,+HAMrCK,OAHAJ,EAAM,qGAMHI,OAHHH,EAAM,wGAMFG,OAHDF,EAAS,yGAGEE,OAAVD,EAAU,+DAjDFT,EA0BjD,IAAsBG,EACpBD,EACAE,EACAC,EACAC,EACAC,EACAC,EACAC,C,GAhCM,G,IAGHtB,MAAK,SAAAa,IAoDV,SAA8BA,GAC5BtB,EAAaiC,mBAAmB,YAAaX,E,CApDzCY,CAAqBZ,GAErB,IAAIa,EAAarC,SAASsC,iBAAiB,eACvCC,EAAgBF,EAAWA,EAAWvB,OAAS,GACnDuB,EAAWG,SAAQ,SAAAC,GACjBC,EAASC,UAAUF,E,IAErBC,EAASE,QAAQL,GAEjBlC,EAAkBwC,UAAY3C,EAAa4C,SAAShC,OAChDT,EAAkBwC,WAAaxC,EAAkBgB,YACnDN,EAAAlB,GAASmB,OAAO+B,QACd,8DAEF3C,EAAWc,UAAUC,IAAI,UACzBuB,EAASC,UAAUJ,IAErBS,EAAQC,S,IA5DdlD,EAAMmD,iBAAiB,UAEvB,SAAkBC,GAChBA,EAAEC,iBAEF5C,GAAa,EACb,IAAM6C,EAAOF,EAAEG,cACTC,EAAQF,EAAKG,SAASC,YAAYF,MAAMG,OAC9CrD,EAAkBoD,YAAcF,EAChCnD,EAAWc,UAAUyC,OAAO,UA0F5BzD,EAAa0D,UAAY,GAvFzBvD,EAAkBwD,YAElBpD,IAAcqD,SAAQ,WACpBT,EAAKU,QACgC,IAAjC7D,EAAa4C,SAAShC,QACxBC,EAAAlB,GAASmB,OAAOgD,QACd,oBAAgD9B,OAA5B7B,EAAkBgB,UAAU,YAEpDb,GAAa,C,OAkFjB,IAAIwC,EAAU,IAAIjC,EAAAkD,GAAJ,CAAmB,iBAO3BvB,EAAW,IAAIwB,sBAErB,SAAkBC,EAASC,GACzBD,EAAQ3B,SAAQ,SAAA6B,GACVA,EAAMC,gBACR7D,G,MAVU,CACd8D,KAAM,KACNC,UAAW,G","sources":["src/js/infinity-scroll.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport GalleryApiService from './gallery-API';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst input = document.getElementById('search-form');\nconst photoGallery = document.querySelector('.gallery');\nconst loadingImg = document.querySelector('#loading-forever');\nconst galleryApiService = new GalleryApiService();\nlet isNewFetch = true;\n\ninput.addEventListener('submit', onSubmit);\n\nfunction onSubmit(e) {\n  e.preventDefault();\n\n  isNewFetch = true;\n  const form = e.currentTarget;\n  const value = form.elements.searchQuery.value.trim();\n  galleryApiService.searchQuery = value;\n  loadingImg.classList.remove('hidden');\n\n  clearGallery();\n  galleryApiService.resetPage();\n\n  fetchPhotos().finally(() => {\n    form.reset();\n    if (photoGallery.children.length !== 0)\n      Notiflix.Notify.success(\n        `Hooray! We found ${galleryApiService.totalHits} images`\n      );\n    isNewFetch = false;\n  });\n}\n\nfunction fetchPhotos() {\n  return galleryApiService\n    .getGallery()\n    .then(gallery => {\n      if (gallery.hits.length === 0 && isNewFetch !== false) {\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        loadingImg.classList.add('hidden');\n      }\n\n      const total = gallery.totalHits;\n      galleryApiService.setTotalHits(total);\n      return gallery.hits.reduce(\n        (markup, photo) => createMarkup(photo) + markup,\n        ''\n      );\n    })\n    .then(markup => {\n      appendPhotoToGallery(markup);\n\n      let photoCards = document.querySelectorAll('.photo-card');\n      let lastPhotoCard = photoCards[photoCards.length - 1];\n      photoCards.forEach(card => {\n        observer.unobserve(card);\n      });\n      observer.observe(lastPhotoCard);\n\n      galleryApiService.elemCount = photoGallery.children.length;\n      if (galleryApiService.elemCount >= galleryApiService.totalHits) {\n        Notiflix.Notify.warning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n        loadingImg.classList.add('hidden');\n        observer.unobserve(lastPhotoCard);\n      }\n      gallery.refresh();\n    });\n}\n\nfunction createMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n     <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n        <div class=\"info\">\n            <p class=\"info-item\">\n                <b>Likes</b> <span>${likes}</span>\n            </p>\n            <p class=\"info-item\">\n                <b>Views</b> <span>${views}</span>\n            </p>\n            <p class=\"info-item\">\n                <b>Comments</b> <span>${comments}</span>\n            </p>\n            <p class=\"info-item\">\n                <b>Downloads</b> <span>${downloads}</span>\n            </p>\n        </div>\n    </div>\n    `;\n}\n\nfunction appendPhotoToGallery(markup) {\n  photoGallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearGallery() {\n  photoGallery.innerHTML = '';\n}\n\nlet gallery = new SimpleLightbox('.photo-card a');\n\nconst options = {\n  root: null,\n  threshold: 1,\n};\n\nconst observer = new IntersectionObserver(onScroll, options);\n\nfunction onScroll(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      fetchPhotos();\n    }\n  });\n}\n"],"names":["$6JpON","parcelRequire","$3009c398e1a659a2$var$input","document","getElementById","$3009c398e1a659a2$var$photoGallery","querySelector","$3009c398e1a659a2$var$loadingImg","$3009c398e1a659a2$var$galleryApiService","$2rXFd","default","$3009c398e1a659a2$var$isNewFetch","$3009c398e1a659a2$var$fetchPhotos","getGallery","then","gallery1","hits","length","$parcel$interopDefault","Notify","failure","classList","add","total","totalHits","setTotalHits","reduce","markup","photo","webformatURL","param","largeImageURL","tags","likes","views","comments","downloads","concat","insertAdjacentHTML","$3009c398e1a659a2$var$appendPhotoToGallery","photoCards","querySelectorAll","lastPhotoCard","forEach","card","$3009c398e1a659a2$var$observer","unobserve","observe","elemCount","children","warning","$3009c398e1a659a2$var$gallery","refresh","addEventListener","e","preventDefault","form","currentTarget","value","elements","searchQuery","trim","remove","innerHTML","resetPage","finally","reset","success","$5IjG7","IntersectionObserver","entries","observer","entry","isIntersecting","root","threshold"],"version":3,"file":"02-pixabay-infinity-scroll.5a657e89.js.map"}